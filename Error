# PS C:\Cyberark Dashboard\epv-api-scripts> C:\Cyberark Dashboard\epv-api-scripts\simple_reports.ps1

Vous aurez besoin de vos identifiants CyberArk pour chaque script.
Type d'authentification: CyberArk
===============================================

--- Rapport des comptes ---
ExÃ©cution de: & ".\Reports\Accounts\Get-AccountReport.ps1" -ReportPath "C:\tmp\AccountReport.csv" -PVWAAddress https://accessqa.st.com/PasswordVault/ -allProps
ERREUR: Invalid URI: The hostname could not be parsed. Run New-PASSession

--- Rapport des membres de coffres ---
ExÃ©cution de: & ".\Reports\Safes\Get-SafeMemberReport.ps1" -ReportPath "C:\tmp\SafeMemberReport.csv" -PVWAAddress https://accessqa.st.com/PasswordVault/ -IncludeGroups -IncludeApps
ERREUR: Invalid URI: The hostname could not be parsed. Run New-PASSession

--- Rapport des comptes dÃ©couverts ---
ExÃ©cution de: & ".\Discovered Accounts\Get-DiscoveredAccountsReport.ps1" -PVWAURL https://accessqa.st.com/PasswordVault/ -List -CSVPath "C:\tmp\DiscoveredAccounts.csv" -AuthType CyberArk -AutoNextPage
Starting script (v1.0)
ERREUR: A parameter cannot be found that matches parameter name 'concurrentSession'.

--- Rapport des utilisateurs inactifs ---
ExÃ©cution de: & ".\User Management\Get-InactiveUsersReport.ps1" -PVWAURL https://accessqa.st.com/PasswordVault/ -CSVPath "C:\tmp\InactiveUsers.csv" -AuthType CyberArk -InactiveDays 30
Starting script (v1.2)
Creating a list of all inactive users from the last 30 days
Generating report
Logoff Session...
Script ended
TerminÃ© avec succÃ¨s

--- Rapport des plateformes ---
ExÃ©cution de: & ".\Platforms\Get-PlatformReport.ps1" -PVWAURL https://accessqa.st.com/PasswordVault/ -CSVPath "C:\tmp\PlatformReport.csv" -AuthType CyberArk -ExtendedReport -IncludeInactive
Starting script (v1.0)
Retrieving active Platform...
Found 241 active Platforms
Generating report...
Logoff Session...æ

TerminÃ© avec succÃ¨s

--- Rapport des risques de comptes ---
ExÃ©cution de: & ".\Security Events\Get-AccoutnsRiskReport.ps1" -PVWAURL https://accessqa.st.com/PasswordVault/ -CSVPath "C:\tmp\AccountRiskReport.csv" -AuthType Cyber
Ark -EventsDaysFilter 30
Starting script (v1.0)
Getting all Security Events in the last 30 days
Finding Account information from 16 events
Retrieving Account information and calculating Risks
Generating report
Logoff Session...
Script ended
TerminÃ© avec succÃ¨s

--- Rapport des sessions PSM ---
ExÃ©cution de: & ".\PSM Sessions Management\PSM-SessionsManagement.ps1" -PVWAURL https://accessqa.st.com/PasswordVault/ -List -CSVPath "C:\tmp\PSMSessions.csv" -AuthTy
pe CyberArk -PSMServerName "PSMServer"
Starting script (v1.0)
Retrieving sessions for PSM Server PSMServer...
Exporting the output to C:\tmp\PSMSessions.csv
Finished retrieving sessions for PSM Server PSMServer
Logoff Session...
Logoff Session...
Script ended
TerminÃ© avec succÃ¨s

--- Rapport des applications AAM ---
ExÃ©cution de: & ".\AAM Applications\Export-Import-Applications.ps1" -PVWAURL https://accessqa.st.com/PasswordVault/ -Export -CSVPath "C:\tmp\AAMApplications.csv" -Aut
hType CyberArk
Starting script (v1.0)
LogoffUrl

---

Header = System.Collections.Hashtable
Found 20 applications
Exporting applications to CSV file...
Logoff Session...

Script Ended
TerminÃ© avec succÃ¨s

--- Rapport d'optimisation des adresses ---
ExÃ©cution de: & ".\Optimize Address\Optimize-Addresses.ps1" -PVWAAddress https://accessqa.st.com/PasswordVault/ -ExportToCSV -CSVPath "C:\tmp\AddressOptimization.csv"
-ShowAllResults
ERREUR: Invalid URI: The hostname could not be parsed. Run New-PASSession

--- Rapport de tous les comptes ---
ExÃ©cution de: & ".\Get Accounts\Get-Accounts.ps1" -PVWAURL https://accessqa.st.com/PasswordVault/ -List -Report -CSVPath "C:\tmp\AllAccounts.csv" -SortBy "UserName" -
AutoNextPage
Retrieving accounts...
C:\Cyberark Dashboard\epv-api-scripts\Get Accounts\Get-Accounts.ps1 : Unauthorized
At line:1 char:1

- & ".\Get Accounts\Get-Accounts.ps1" -PVWAURL https://accessqa.st.com/ ...
- ```
    + CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException
    + FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,Get-Accounts.ps1
  ```

Showing 2 accounts
ERREUR: {"ErrorCode":"CASTM006E","ErrorMessage":"Transaction failed because logon was not called with this Session Instance."}

===============================================
RÃ©sumÃ© des rapports gÃ©nÃ©rÃ©s:

- AAMApplications.csv
- AccountRiskReport.csv
- InactiveUsers.csv
- PlatformReport.csv
- PSMSessions.csv

Attention: Des erreurs ont Ã©tÃ© dÃ©tectÃ©es. Consultez le fichier C:\tmp\erreurs.log
