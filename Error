=====================================================
      CyberArk Dashboard Requirements Installer
======================================================
This script will run all necessary scripts to populate the CyberArk dashboards to 100%.
You will be prompted for the required information for each script.
======================================================

Specify the output folder for CSV files (Default: C:\Temp): 

Enter PVWA URL (e.g., https://pvwa.cyberark.local/PasswordVault): https://accessqa.st.com/

Select Authentication Type:
1. CyberArk (default)
2. LDAP
3. RADIUS
Enter your choice (1-3): 1

[1/12] System Health Script
Do you want to run System-Health.ps1? (Y/N) [Y]: Y
[System-Health.ps1] Executing: ./System-Health.ps1 -PVWAURL 'https://accessqa.st.com/' -AuthType CyberArk -ExportPath 'C:\Temp' -OutputCSV System_Health.csv
[System-Health.ps1] Error: At C:\Cyberark Dashboard\epv-api-scripts\System Health\System-Health.ps1:26 char:1
+ [CmdletBinding()]
+ ~~~~~~~~~~~~~~~~~
Unexpected attribute 'CmdletBinding'.

At C:\Cyberark Dashboard\epv-api-scripts\System Health\System-Health.ps1:27 char:1
+ param(
+ ~~~~~
Unexpected token 'param' in expression or statement.

At C:\Cyberark Dashboard\epv-api-scripts\System Health\System-Health.ps1:35 char:25
+     [String]$AuthType = "cyberark",
+                         ~~~~~~~~~~
The assignment expression is not valid. The input to an assignment operator must be an object that is able to accept assignments, such as a variable or a property.

[2/12] Safe Management Script
Do you want to run Safe-Management.ps1? (Y/N) [Y]: Y
[Safe-Management.ps1] Executing: ./Safe-Management.ps1 -PVWAURL 'https://accessqa.st.com/' -AuthType CyberArk -Report -OutputPath 'C:\Temp/Safes.csv'
=======================================
Starting script (v2.2.2)
Error Logging on. Error: Get-LogonHeader: 
[Safe-Management.ps1] Completed

[3/12] Get Accounts Script
Do you want to run Get-Accounts.ps1? (Y/N) [Y]: y
[Get-Accounts.ps1] Executing: ./Get-Accounts.ps1 -PVWAURL 'https://accessqa.st.com/' -List -Report -AutoNextPage -CSVPath 'C:\Temp/Accounts.csv'
Error Logging on. Error: Source:; Message: Get-LogonHeader: Method Not Allowed
	->Source:Microsoft.PowerShell.Commands.Utility; Message: The remote server returned an error: (405) Method Not Allowed.
[Get-Accounts.ps1] Completed

[4/12] Account Risk Report Script
Do you want to run Get-AccountReport.ps1? (Y/N) [Y]: 
[Get-AccountReport.ps1] Executing: ./Get-AccountReport.ps1 -PVWAAddress 'https://accessqa.st.com/' -PVWAAuthType CyberArk -ReportPath 'C:\Temp/Accounts_Risk.csv' -allP
rops
[Get-AccountReport.ps1] Error: Invalid URI: The hostname could not be parsed. Run New-PASSession

[5/12] User Activity Report Script
Do you want to run Get-UsersActivityReport.ps1? (Y/N) [Y]: y
Enter number of days of history to extract (default: 30): 30
[Get-UsersActivityReport.ps1] Executing: ./Get-UsersActivityReport.ps1 -PVWA 'https://accessqa.st.com/' -AuthType CyberArk -Days 30 -ExportPath 'C:\Temp' -OutputCSV Us
ers_Activity.csv
[Get-UsersActivityReport.ps1] Error: The term './Get-UsersActivityReport.ps1' is not recognized as the name of a cmdlet, function, script file, or operable program. Ch
eck the spelling of the name, or if a path was included, verify that the path is correct and try again.

[6/12] PSM Sessions Management Script
Do you want to run PSM-SessionsManagement.ps1? (Y/N) [Y]: Y
Enter number of days of history to extract (default: 30): 
[PSM-SessionsManagement.ps1] Executing: ./PSM-SessionsManagement.ps1 -PVWA 'https://accessqa.st.com/' -AuthType CyberArk -Days 30 -ExportPath 'C:\Temp' -OutputCSV PSM_
Sessions.csv
[PSM-SessionsManagement.ps1] Error: A parameter cannot be found that matches parameter name 'Days'.

[7/12] Test HTML5 Gateway Script
Do you want to run Test-HTML5Gateway.ps1? (Y/N) [Y]: 
Enter the HTML5 Gateway URL (e.g., https://gateway.cyberark.local): 
Gateway URL cannot be empty. Please enter a valid URL: 
Gateway URL cannot be empty. Please enter a valid URL: /
[Test-HTML5Certificate.ps1] Executing: ./Test-HTML5Certificate.ps1 -Gateway '/' -ExportPath 'C:\Temp' -OutputCSV HTML5_Gateway_Test.csv
[Test-HTML5Certificate.ps1] Error: A parameter cannot be found that matches parameter name 'Gateway'.

[8/12] Get Ad-Hoc Access Script
Do you want to run Get-AdHocAccess.ps1? (Y/N) [Y]: 
[Get-AdHocAccess.ps1] Executing: ./Get-AdHocAccess.ps1 -PVWA 'https://accessqa.st.com/' -AuthType CyberArk -ExportPath 'C:\Temp' -OutputCSV AdHoc_Access.csv
[Get-AdHocAccess.ps1] Error: Cannot validate argument on parameter 'AuthType'. The argument "CyberArk" does not belong to the set "ldap,radius" specified by the Valida
teSet attribute. Supply an argument that is in the set and then try the command again.

[9/12] Bulk Account Actions Script
Do you want to run Invoke-BulkAccountActions.ps1? (Y/N) [Y]: 
[Invoke-BulkAccountActions.ps1] Executing: ./Invoke-BulkAccountActions.ps1 -PVWAURL 'https://accessqa.st.com/' -AuthType CyberArk -AccountsAction 'Verify' -ExportPath 
'C:\Temp' -OutputCSV Accounts_Usage.csv
[Invoke-BulkAccountActions.ps1] Error: A parameter cannot be found that matches parameter name 'ExportPath'.

[10/12] Get Applications Script
Do you want to run Get-Applications.ps1? (Y/N) [Y]: 
Get-Applications.ps1 not found in AAM Applications directory.
Please locate the script manually and run it with the following parameters:
-PVWA 'https://accessqa.st.com/' -AuthType CyberArk -ExportPath 'C:\Temp' -OutputCSV Applications.csv

[11/12] Get CCP Performance Script
Do you want to run Get-CCPPerformance.ps1? (Y/N) [Y]: 
Get-CCPPerformance.ps1 not found in CCP Setup directory.
Please locate the script manually and run it with the following parameters:
-CCP '' -Days 30 -ExportPath 'C:\Temp' -OutputCSV CCP_Performance.csv

[12/12] Get Platforms Script
Do you want to run Get-Platforms.ps1? (Y/N) [Y]: 
Get-Platforms.ps1 not found in Platforms directory.
Please locate the script manually and run it with the following parameters:
-PVWA 'https://accessqa.st.com/' -AuthType CyberArk -ExportPath 'C:\Temp' -OutputCSV Platforms.csv

======================================================
                Script Execution Summary               
======================================================
All scripts have been executed. CSV files are available in: C:\Temp

These files can now be uploaded to the CyberArk Dashboard to populate all dashboards at 100%.
======================================================

PS C:\Cyberark Dashboard\epv-api-scripts> 